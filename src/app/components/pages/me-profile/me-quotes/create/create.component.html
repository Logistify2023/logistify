<div class="modal-general">
  <div class="modal-content modal-dialog">
    <mat-dialog-content class="mat-typography modal-body">
      <div class="form form-step">
        <div class="pasos current" data-step="step-1">
          <mat-stepper [linear]="true" #stepper>

            <mat-step [stepControl]="firstFormGroup" label="Datos para cotizar">
              <form class="row" [formGroup]="firstFormGroup">
                <div class="container" *ngIf="!loading_quote">

                  <!-- Seleccione un cliente and services(products) -->
                  <div class="row col-12">
                    <div class="col-lg-6 col-md-6 col-sm-12">
                      <mat-form-field appearance="outline">
                        <mat-label> Seleccione un cliente </mat-label>
                        <mat-select formControlName="id_customer" (selectionChange)="changeUserSelected()">
                          <mat-option *ngFor="let item of listCustomers" [value]="item.id"> {{ item.business_name }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                      <mat-form-field appearance="outline">
                        <mat-label>Seleccione los productos</mat-label>
                        <mat-select formControlName="id_products" multiple [disabled]="listServicesClient.length <= 0">
                          <mat-option *ngFor="let item of listServicesClient" [value]="item.service_id"> {{ item.service.service }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>

                  <!-- Datos origen && Datos destino -->
                  <div class="row col-12">
                    <!-- Datos origen -->
                    <div class="quote-origin col-lg-6 col-md-6 col-sm-12">
                      <h4 class="text">Origen</h4>
                      <div class="col-2 mb-3">
                        <mat-checkbox class="d-block text-start" #checkboxOrigin (click)="setValueNullAddressOrigin()">Otra dirección</mat-checkbox>
                      </div>
                      <mat-form-field appearance="outline" *ngIf="checkboxOrigin.checked">
                        <mat-label> Código postal origen </mat-label>
                        <input matInput type="text" minlength="5" maxlength="5" formControlName="origin_postal_code" (change)="validateCPCreate_Origin()">
                        <mat-icon matSuffix>search</mat-icon>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="!checkboxOrigin.checked">
                        <mat-label> Identificador sucursal </mat-label>
                        <mat-select formControlName="branch_office_origin" [(ngModel)]="valueSelectPostalCodeOrigin" (selectionChange)="selectPostalCodeOrigin()">
                          <mat-option *ngFor="let item of listAddressUser" [value]="item.id"> {{ item.contact?.branch_office }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="!checkboxOrigin.checked">
                        <mat-label> Código postal </mat-label>
                        <input matInput formControlName="origin_postal_code" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Estado </mat-label>
                        <input matInput type="text" formControlName="origin_state" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Ciudad </mat-label>
                        <input matInput type="text" formControlName="origin_city" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Municipio </mat-label>
                        <input matInput type="text" formControlName="origin_municipality" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="checkboxOrigin.checked">
                        <mat-label> Colonia </mat-label>
                        <mat-select formControlName="origin_settlement" (selectionChange)="selectSettlementOrigin()">
                          <mat-option *ngFor="let item of listSettlement_Origin" [value]="item.id"> {{ item.settlement }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="!checkboxOrigin.checked">
                        <mat-label> Colonia </mat-label>
                        <input matInput type="text" formControlName="origin_settlement" readonly>
                      </mat-form-field>
                    </div>
                    <!-- Datos destino -->
                    <div class="quote-destin col-lg-6 col-md-6 col-sm-12">
                      <h4 class="text">Destino</h4>
                      <div class="col-2 mb-3">
                        <mat-checkbox class="d-block text-start" #checkboxDestin (click)="setValueNullAddressDestin()">Otra dirección</mat-checkbox>
                      </div>
                      <mat-form-field appearance="outline" *ngIf="checkboxDestin.checked">
                        <mat-label> Código postal </mat-label>
                        <input matInput type="text" minlength="5" maxlength="5" formControlName="destin_postal_code" (change)="validateCPCreate_Destiny()">
                        <mat-icon matSuffix>search</mat-icon>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="!checkboxDestin.checked">
                        <mat-label> Identificador sucursal </mat-label>
                        <mat-select formControlName="branch_office_destin" [(ngModel)]="valueSelectPostalCodeDestin" (selectionChange)="selectPostalCodeDestin()">
                          <mat-option *ngFor="let item of listAddressUser" [value]="item.id"> {{ item.contact?.branch_office }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="!checkboxDestin.checked">
                        <mat-label> Código postal de destino </mat-label>
                        <input matInput type="text" formControlName="destin_postal_code" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Estado </mat-label>
                        <input matInput type="text" formControlName="destin_state" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Ciudad </mat-label>
                        <input matInput type="text" formControlName="destin_city" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Municipio </mat-label>
                        <input matInput type="text" formControlName="destin_municipality" readonly>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="checkboxDestin.checked">
                        <mat-label> Colonia </mat-label>
                        <mat-select formControlName="destin_settlement" (selectionChange)="selectSettlementDestin()">
                          <mat-option *ngFor="let item of listSettlement_Destiny" [value]="item.id"> {{ item.settlement }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                      <mat-form-field appearance="outline" *ngIf="!checkboxDestin.checked">
                        <mat-label> Colonia </mat-label>
                        <input matInput type="text" formControlName="destin_settlement" readonly>
                      </mat-form-field>
                    </div>
                  </div>

                  <!-- Servicios adicionales -->
                  <div class="row col-12">
                    <h4 class="text">Servicios adicionales</h4>
                    <div class="row">
                      <div class="col mb-2" *ngFor="let charge of listAdditionalChargesByAuto">
                        <mat-checkbox class="d-block text-start" (change)="checkAdditionalCharge(charge)">{{ charge.addition_charge}}</mat-checkbox>
                      </div>
                    </div>
                    <div class="row" [hidden]="hiddenInputValueDeclared">
                      <mat-form-field appearance="outline">
                        <mat-label>Monto a asegurar</mat-label>
                        <input matInput type="number" formControlName="insurance">
                      </mat-form-field>
                    </div>
                    <div class="row">
                      <mat-form-field appearance="outline">
                        <mat-label>Cargos adicionales opcionales</mat-label>
                        <mat-select formControlName="additionals" multiple>
                          <mat-option *ngFor="let item of listAdditionalChargesByUser" [value]="item.id"> {{ item.addition_charge }} </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>

                  <!-- Paquetes y mercancías -->
                  <div class="row col-12">
                    <h4 class="text">Paquetes y mercancías.</h4>
                    <div class="row col-12">
                      <div class="col-lg-6 col-md-6 col-sm-6">
                        <div class="form-check">
                          <mat-checkbox class="d-block text-center" #checkboxPackage>Paquetes</mat-checkbox>
                        </div>
                      </div>
                      <div class="col-lg-6 col-md-6 col-sm-6">
                        <div class="form-check">
                          <mat-checkbox class="d-block text-center" #checkboxProducts >Mercancías</mat-checkbox>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-array-input" formArrayName="packages" [hidden]="!checkboxPackage.checked">
                        <div class="row mb-3">
                          <div class="col">
                            <span class="btn btn-small btn-primary btn-square" (click)="addPackagesParam()">
                              <mat-icon aria-hidden="false" aria-label="Agregar nueva" fontIcon="add"></mat-icon> Agregar paquete
                            </span>
                          </div>
                        </div>
                        <div class="row mb-3" *ngFor="let quantity of  packagesParam().controls; let i=index"
                          [formGroupName]="i">
                          <div class="row d-flex justify-content-end">
                            <div class="col-1">
                              <button class="btn btn-delete btn-transparent text-end" title="Eliminar" (click)="removePackagesParam(i)">
                                <mat-icon aria-hidden="false" aria-label="Eliminar" fontIcon="delete_forever" ></mat-icon>
                              </button>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Tipo </mat-label>
                                <mat-select formControlName="type">
                                  <mat-option value="PAQUETE"> PAQUETE </mat-option>
                                  <mat-option value="SOBRE"> SOBRE </mat-option>
                                </mat-select>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Largo </mat-label>
                                <input matInput type="number" formControlName="long" min="0" required>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Ancho </mat-label>
                                <input matInput type="number" formControlName="width" min="0" required>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Alto </mat-label>
                                <input matInput type="number" formControlName="high" min="0" required>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Peso </mat-label>
                                <input matInput type="number" formControlName="weight" min="0" required>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Cantidad </mat-label>
                                <input matInput type="number" formControlName="quantity" min="1" required>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Campaña </mat-label>
                                <input matInput type="text" formControlName="campaign">
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Centro de costos </mat-label>
                                <input matInput type="text" formControlName="cost_center">
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Contenido </mat-label>
                                <input matInput type="text" formControlName="content" required>
                              </mat-form-field>
                            </div>
                            <div class="col">
                              <mat-form-field appearance="outline">
                                <mat-label> Descripción </mat-label>
                                <input matInput type="text" formControlName="description">
                              </mat-form-field>
                            </div>
                          </div>
                        </div>
                      </div>

                      <hr [hidden]="!checkboxPackage.checked">
                      
                      <div class="form-array-input" formArrayName="products" [hidden]="!checkboxProducts.checked">
                        <span class="text-danger" *ngIf="listProducts.length == 0"><h4>No hay mercancías disponibles</h4></span>
                        <div class="row mb-3" *ngIf="listProducts.length > 0">
                          <div class="col-12 text-end">
                            <span class="btn btn-small btn-primary btn-square" (click)="addProductsParam()">
                              <mat-icon aria-hidden="false" aria-label="Agregar nueva" fontIcon="add"></mat-icon> Agregar mercancía
                            </span>
                          </div>
                        </div>
                        <div class="row mb-2" *ngFor="let quantity of  productsParam().controls; let i=index"
                          [formGroupName]="i">
                          <div class="col-2">
                            <mat-form-field appearance="outline">
                              <mat-label> Cantidad </mat-label>
                              <input matInput type="number" formControlName="quantity" min="0">
                            </mat-form-field>
                          </div>
                          <div class="col-4">
                            <mat-form-field appearance="outline">
                              <mat-label> Mercancía </mat-label>
                              <mat-select formControlName="id">
                                <mat-option *ngFor="let item of listProducts" [value]="item.id"> {{ item.name }} </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                          <div class="col-2">
                            <mat-form-field appearance="outline">
                              <mat-label> Campaña </mat-label>
                              <input matInput type="text" formControlName="campaign">
                            </mat-form-field>
                          </div>
                          <div class="col-2">
                            <mat-form-field appearance="outline">
                              <mat-label> Centro de costos </mat-label>
                              <input matInput type="text" formControlName="cost_center">
                            </mat-form-field>
                          </div>
                          <div class="col-2 text-end">
                            <button class="btn btn-delete btn-transparent" (click)="removeProductsParam(i)">
                              <mat-icon aria-hidden="false" aria-label="Eliminar" fontIcon="delete_forever"></mat-icon>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- errorMessages -->
                  <div class="row col-12">
                    <small class="error d-block text-start invalid-feedback mt-2" *ngIf="errorMessages" [innerHTML]="errorMessages"> </small>
                  </div>

                  <div class="controls">
                    <button mat-button class="btn btn-secondary" (click)="onSubmit()"> Cotizar </button>
                    <button mat-button class="btn btn-primary m-3" [hidden]="hiddenSteperNext" matStepperNext> Ver Cotizaciones </button>
                  </div>
                </div>
                <div class="loading" *ngIf="loading_quote">
                  <img width="75%" height="70%" src="assets/img/loader.svg">
                  <p>C o t i z a n d o . . . </p>
                </div>
              </form>
            </mat-step>

            <mat-step [stepControl]="secondFormGroup" label="Listado cotizaciones">
              <div class="container">
                <div class="row">

                  <!-- Filters and orders -->
                  <div class="col-12 mb-3 d-grid justify-content-center">
                    <mat-button-toggle-group aria-label="Font Style">
                      <mat-button-toggle (click)="orderPrice()"> Ordenar por precio
                        <mat-icon fontIcon="arrow_drop_down" *ngIf="!orderByPrice"></mat-icon>
                        <mat-icon fontIcon="arrow_drop_up" *ngIf="orderByPrice"></mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle (click)="orderDate()"> Ordenar por fecha
                        <mat-icon fontIcon="arrow_drop_down" *ngIf="!orderByDate"></mat-icon>
                        <mat-icon fontIcon="arrow_drop_up" *ngIf="orderByDate"></mat-icon>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </div>

                  <form class="row" [formGroup]="secondFormGroup">
                    <div class="row quote_view_detail">

                      <!-- Cards to quote -->
                      <div class="mb-3" *ngFor="let item  of listQuotesResponseAvailable">
                        <div class="card mat-elevation-z4">
                          <div class="row mt-2">
                            <!-- Primer apartado -->
                            <div class="col-lg-2 col-md-2 col-sm-12 d-flex align-items-center p-3">
                              <img src="{{item.datas.courier.image}}" alt="Mensajería" class="img-fluid">
                            </div>
                            <!-- Segundo apartado -->
                            <div class="col-lg-3 col-md-3 col-sm-4">
                              <span class="card-text" title="Servicio"><mat-icon fontIcon="local_shipping"></mat-icon> {{item.datas.service.service_type}} </span>
                              <span class="card-text" title="Fecha entrega"><mat-icon fontIcon="calendar_today"></mat-icon> {{item.dates.delivery_date}} </span>
                              <span class="card-text" title="Peso cotizado"><mat-icon fontIcon="line_weight"></mat-icon> {{item.numbers.weight}} kg </span>
                            </div>
                            <!-- Tercer apartado -->
                            <div class="col-lg-3 col-md-3 col-sm-4">
                              <span class="card-text" title="Estado origen"><mat-icon fontIcon="location_on"></mat-icon> {{item.origin.state.substr(0, 3)}} </span>
                              <span class="card-text" title="Estado destino"><mat-icon fontIcon="location_on"></mat-icon> {{item.destin.state.substr(0, 3)}} </span>
                              <span class="card-text" title="Días adicionales"><mat-icon fontIcon="today"></mat-icon> {{item.numbers.additional_days}} día(s) adicionales </span>
                            </div>
                            <!-- Cuarto apartado -->
                            <div class="col-lg-3 col-md-3 col-sm-3">
                              <span class="card-text" title="Número piezas"><mat-icon fontIcon="shopping_basket"></mat-icon> {{item.numbers.pieces}} </span>
                              <p class="card-text" title="Precio total">${{ item.numbers?.total.toFixed(2)}} MXN</p>
                              <span class="card-text">IVA incluido.</span>
                            </div>
                            <!-- Quinto apartado -->
                            <div class="col-lg-1 col-md-1 col-sm-1 options">
                              <a class="btn-small btn-link" (click)="openModalDetails(item.id)" title="Más detalles"><mat-icon fontIcon="remove_red_eye"></mat-icon></a>
                              <a class="btn-small btn-link" *ngIf="!disabledBtnPdf" (click)="downloadQuotePdf(item.id, item.datas.service.slug + '.pdf')" title="Descargar PDF"><mat-icon fontIcon="picture_as_pdf"></mat-icon></a>
                              <a class="btn-small btn-link" *ngIf="disabledBtnPdf" title="Descargar PDF"><mat-icon fontIcon="picture_as_pdf"></mat-icon></a>
                              <button mat-button class="btn btn-small btn-link" *ngIf="!disabledBtnPdf" (click)="createShipment(item)" title="Generar envío" matStepperNext><mat-icon fontIcon="send"></mat-icon></button>
                              <button mat-button class="btn btn-small btn-link" *ngIf="disabledBtnPdf" title="Generar envío" disabled><mat-icon fontIcon="send"></mat-icon></button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Cards no quote -->
                      <p class="text p-3" *ngIf="listQuotesResponseNotAvailable.length > 0">Productos no cotizados</p>
                      <div class="mb-3" *ngFor="let item  of listQuotesResponseNotAvailable">
                        <!-- Cards no quote -->
                        <div class="card not_available mat-elevation-z4">
                          <div class="row mt-2">
                            <div class="col-lg-3 col-md-3 col-sm-12 align-items-center p-3">
                              <img src="{{item.datas.courier.image}}" alt="Mensajería" class="img-fluid">
                              <hr>
                              <span class="card-text" title="Servicio"> <mat-icon fontIcon="local_shipping"></mat-icon> {{item.datas.service.service_type}} </span>
                              <span class="card-text" title="Fecha cotizado"> <mat-icon fontIcon="calendar_today"></mat-icon> {{item.dates.delivery_date}} </span>
                            </div>
                            <div class="col-lg-9 col-md-9 col-sm-12">
                              <dl class="card-text" *ngFor="let message of item.payload">
                                <dd><mat-icon fontIcon="info"></mat-icon>{{ message }}</dd>
                              </dl>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div>
                  </form>

                </div>
                <div class="controls">
                  <button mat-button class="btn btn-morado mx-2" matStepperPrevious> Regresar </button>
                </div>
              </div>
            </mat-step>

            <mat-step [stepControl]="thirdFormGroup" label="Generar guía">
              <form [formGroup]="thirdFormGroup">
                <div class="container">
                  <div class="row">

                    <!-- Remitente -->
                    <div class="col-lg-4 col-md-4 col-sm-12">
                      <h4 class="text text-start">Datos origen</h4>
                      <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Código postal </mat-label>
                            <input matInput type="text" formControlName="origin_postal_code" readonly>
                          </mat-form-field>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Estado </mat-label>
                            <input matInput type="text" formControlName="origin_state" readonly>
                          </mat-form-field>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Ciudad </mat-label>
                            <input matInput type="text" formControlName="origin_city" readonly>
                          </mat-form-field>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Municipio </mat-label>
                            <input matInput type="text" formControlName="origin_municipality" readonly>
                          </mat-form-field>
                        </div>
                      </div>
                      <mat-form-field appearance="outline">
                        <mat-label> Colonia </mat-label>
                        <input matInput type="text" formControlName="origin_settlement" readonly>
                      </mat-form-field>
                      <!-- Datos ubicación -->
                      <mat-form-field appearance="outline">
                        <mat-label> Calle </mat-label>
                        <input matInput type="text" formControlName="origin_street">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Suburbio </mat-label>
                        <input matInput type="text" formControlName="origin_suburb">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Ubicación </mat-label>
                        <input matInput type="text" formControlName="origin_location">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Referencia </mat-label>
                        <input matInput type="text" formControlName="origin_reference">
                      </mat-form-field>
                      <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Num. Exterior </mat-label>
                            <input matInput type="text" formControlName="origin_outdoor_number">
                          </mat-form-field>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Num. Interior </mat-label>
                            <input matInput type="text" formControlName="origin_interior_number">
                          </mat-form-field>
                        </div>
                      </div>
                      <!-- Datos de contacto -->
                      <mat-form-field appearance="outline">
                        <mat-label> Identificador </mat-label>
                        <input matInput type="text" formControlName="origin_branch_office">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Empresa </mat-label>
                        <input matInput type="text" formControlName="origin_business">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Contacto </mat-label>
                        <input matInput type="text" formControlName="origin_contact">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Puesto </mat-label>
                        <input matInput type="text" formControlName="origin_stall">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> R.F.C. </mat-label>
                        <input matInput type="text" formControlName="origin_rfc">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Teléfono </mat-label>
                        <input matInput type="number" formControlName="origin_phone">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Correo electrónico </mat-label>
                        <input matInput type="email" formControlName="origin_email">
                      </mat-form-field>
                    </div>

                    <!-- Destinatario -->
                    <div class="col-lg-4 col-md-4 col-sm-12">
                      <h4 class="text text-start">Datos destino</h4>
                      <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Código postal </mat-label>
                            <input matInput type="text" formControlName="destin_postal_code" readonly>
                          </mat-form-field>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Estado </mat-label>
                            <input matInput type="text" formControlName="destin_state" readonly>
                          </mat-form-field>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Ciudad </mat-label>
                            <input matInput type="text" formControlName="destin_city" readonly>
                          </mat-form-field>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Municipio </mat-label>
                            <input matInput type="text" formControlName="destin_municipality" readonly>
                          </mat-form-field>
                        </div>
                      </div>
                      <mat-form-field appearance="outline">
                        <mat-label> Colonia </mat-label>
                        <input matInput type="text" formControlName="destin_settlement" readonly>
                      </mat-form-field>
                      <!-- Datos ubicación destino -->
                      <mat-form-field appearance="outline">
                        <mat-label> Calle </mat-label>
                        <input matInput type="text" formControlName="destin_street">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Suburbio </mat-label>
                        <input matInput type="text" formControlName="destin_suburb">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Ubicación </mat-label>
                        <input matInput type="text" formControlName="destin_location">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Referencia </mat-label>
                        <input matInput type="text" formControlName="destin_reference">
                      </mat-form-field>
                      <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Num. Exterior </mat-label>
                            <input matInput type="text" formControlName="destin_outdoor_number">
                          </mat-form-field>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                          <mat-form-field appearance="outline">
                            <mat-label> Num. Interior </mat-label>
                            <input matInput type="text" formControlName="destin_interior_number">
                          </mat-form-field>
                        </div>
                      </div>
                      <!-- Datos contacto destino -->
                      <mat-form-field appearance="outline">
                        <mat-label> Identificador </mat-label>
                        <input matInput type="text" formControlName="destin_branch_office">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Empresa </mat-label>
                        <input matInput type="text" formControlName="destin_business">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Contacto </mat-label>
                        <input matInput type="text" formControlName="destin_contact">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Puesto </mat-label>
                        <input matInput type="text" formControlName="destin_stall">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> R.F.C. </mat-label>
                        <input matInput type="text" formControlName="destin_rfc">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Teléfono </mat-label>
                        <input matInput type="number" formControlName="destin_phone">
                      </mat-form-field>
                      <mat-form-field appearance="outline">
                        <mat-label> Correo electrónico </mat-label>
                        <input matInput type="email" formControlName="destin_email">
                      </mat-form-field>
                    </div>

                    <!-- Precios, servicios y paquetes -->
                    <div class="col-lg-4 col-md-4 col-sm-12">
                      <!-- Imagen mensajería -->
                      <div class="row">
                        <div class="text-center col-lg-9 col-md-8 col-sm-7 mb-3">
                          <img src="{{quoteToShip?.datas.courier.image}}" alt="Mensajería" class="img-fluid">
                        </div>
                      </div>
                      <!-- Detalles del pedido -->
                      <div class="row mb-3">
                        <h4 class="text">Detalle envío para {{ quoteToShip?.datas?.profile.profile }}</h4>
                        <div class="col-lg-6 col-md-6 col-sm-6 text-start">
                          <label> Número de piezas: </label> <br/>
                          <label> Días adicionales: </label> <br/>
                          <label> Peso cotizado: </label> <br/>
                          <label> Valor declarado: </label> <br/>
                          <hr>
                          <label> Cargos adicionales: </label> <br/>
                          <label> Seguro: </label> <br/>
                          <label> Flete: </label> <br/>
                          <label> Cargo combustible: </label> <br/>
                          <label> Subtotal: </label> <br/>
                          <label> IVA: </label> <br/>
                          <label class="mb-1"> TOTAL: </label> <br/>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6 text-start">
                          <label> <strong> {{ quoteToShip?.numbers?.pieces }} </strong> </label> <br/>
                          <label> <strong> {{ quoteToShip?.numbers?.additional_days }} </strong> </label> <br/>
                          <label> <strong> {{ quoteToShip?.numbers?.weight }} KG </strong> </label> <br/>
                          <label> <strong> {{ quoteToShip?.numbers?.value_declared.toFixed(2) }} </strong> </label> <br/>
                          <hr>
                          <label> <strong> ${{ quoteToShip?.numbers?.charges_add.toFixed(2) }} </strong> </label> <br/>
                          <label> <strong> ${{ quoteToShip?.numbers?.secure.toFixed(2) }} </strong> </label> <br/>
                          <label> <strong> ${{ quoteToShip?.numbers?.freight.toFixed(2) }} </strong> </label> <br/>
                          <label> <strong> ${{ quoteToShip?.numbers?.fuel.toFixed(2) }} </strong> </label> <br/>
                          <label> <strong> ${{ quoteToShip?.numbers?.subtotal.toFixed(2) }} </strong> </label> <br/>
                          <label> <strong> ${{ quoteToShip?.numbers?.iva.toFixed(2) }} </strong> </label> <br/>
                          <label class="mb-1"> <strong>${{ quoteToShip?.numbers?.total.toFixed(2) }} </strong> </label> <br/>
                        </div>
                      </div>
                      <!-- Paquetes -->
                      <div class="row mb-2">
                        <h4 class="text">Piezas incluidas</h4>
                        <div class="row col-12" *ngFor="let package of quoteToShip?.packages">
                          <div class="col-lg-4 col-md-4 col-sm-12 text-start">
                            <strong> {{ package.type }} </strong><label class="mb-3"> Tipo </label> <br/>
                            <strong> {{ package.quantity }} </strong><label class="mb-3"> Cantidad </label> <br/>
                            <strong> {{ package.long }} </strong><label class="mb-3"> Largo </label> <br/>
                            <strong> {{ package.width }} </strong><label class="mb-3"> Ancho </label> <br/>
                            <strong> {{ package.high }} </strong><label class="mb-3"> Alto </label> <br/>
                            <strong> {{ package.weight }} </strong><label class="mb-3"> Peso </label> <br/>
                          </div>
                          <div class="col-lg-8 col-md-8 col-sm-12 text-start">
                            <strong> {{ package.campaign }} </strong><label class="mb-3"> Campaña </label> <br/>
                            <strong> {{ package.cost_center }} </strong><label class="mb-3"> Centro costos </label> <br/>
                            <strong> {{ package.content }} </strong><label class="mb-3"> Contenido </label> <br/>
                            <strong> {{ package.description }} </strong><label class="mb-3"> Descripción </label> <br/>
                          </div>
                          <hr>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Charges and services -->
                  <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12" *ngIf="quoteToShip?.services && quoteToShip?.services.length > 0">
                      <h4 class="text">Servicios adicionales</h4>
                      <div class="col mb-2 text-start" *ngFor="let service of quoteToShip?.services">
                        <strong> ${{ service?.price?.toFixed(2) }} </strong><label class="mb-3"> {{ service.service }} </label>
                      </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12" *ngIf="quoteToShip?.charges && quoteToShip?.charges.length > 0">
                      <h4 class="text">Cargos adicionales</h4>
                      <div class="col mb-2 text-start" *ngFor="let charge of quoteToShip?.charges">
                        <strong> ${{ charge?.price?.toFixed(2) }} </strong><label class="mb-3"> {{ charge.service }} </label>
                      </div>
                    </div>
                  </div>

                  <!-- ErrorMessages -->
                  <div class="row">
                    <div class="col-12">
                      <small class="error d-block text-start invalid-feedback mt-2" *ngIf="errorMessages" [innerHTML]="errorMessages"></small>
                    </div>
                  </div>

                  <!-- Buttons -->
                  <div class="controls">
                    <button mat-button class="btn btn-morado mx-2" matStepperPrevious> Regresar </button>
                    <button mat-button class="btn btn-secondary" (click)="generateGuideByQuote()" [disabled]="thirdFormGroup.invalid || loading_ship"> Generar guía </button>
                  </div>

                </div>
              </form>
            </mat-step>

          </mat-stepper>
        </div>
      </div>
    </mat-dialog-content>
    <button class="btn btn-morado btn-cuadrado" type="button" mat-dialog-close> Cancelar </button>
  </div>
</div>